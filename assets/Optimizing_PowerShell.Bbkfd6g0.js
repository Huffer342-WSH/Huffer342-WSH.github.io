import{_ as g}from"./ValaxyMain.vue_vue_type_style_index_0_lang.45YYFxBa.js";import{f as y,a as c}from"./chunks/vue-router.aOcOW5FA.js";import{A as d,M as u,a3 as l,u as m,N as F,U as a,S as s,W as i}from"./framework.CrQDr1gD.js";import"./app.BysTI9HO.js";import"./chunks/dayjs.Byk5cVHE.js";import"./chunks/vue-i18n.KUtIpHG9.js";import"./chunks/pinia.HY29yXn_.js";import"./chunks/@vueuse/motion.CRM0IDQD.js";import"./chunks/nprogress.Cino7761.js";import"./YunComment.vue_vue_type_style_index_0_lang.BF_gtew7.js";import"./index.C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.BK-sBKTS.js";import"./post.B3t-mDxK.js";const w="/assets/pwsh-error-display.4VQtNNvv.png",C="/assets/wt0.CfaZ0fon.png",b="/assets/wt1.CLdois5I.png",v="/assets/my-theme.BitKYrn7.png",D=y("/posts/myNotes/guide/Optimizing_PowerShell",async t=>JSON.parse('{"title":"优化PowerShell","description":"","frontmatter":{"layout":"post","title":"优化PowerShell","date":"2024-10-03 19:55:00","categories":["教程"],"excerpt":"PowerShell按键优化+美化"},"headers":[{"level":2,"title":"0. 精简版","slug":"_0-精简版","link":"#_0-精简版","children":[]},{"level":2,"title":"1. 修改powershell编码","slug":"_1-修改powershell编码","link":"#_1-修改powershell编码","children":[]},{"level":2,"title":"2. 优化 PowerShell 补全","slug":"_2-优化-powershell-补全","link":"#_2-优化-powershell-补全","children":[{"level":3,"title":"2.1 安装并加载 PSReadLine 模块","slug":"_2-1-安装并加载-psreadline-模块","link":"#_2-1-安装并加载-psreadline-模块","children":[]},{"level":3,"title":"2.2 修改 PowerShell 配置","slug":"_2-2-修改-powershell-配置","link":"#_2-2-修改-powershell-配置","children":[]}]},{"level":2,"title":"3. 安装 oh-my-posh 来美化powershell","slug":"_3-安装-oh-my-posh-来美化powershell","link":"#_3-安装-oh-my-posh-来美化powershell","children":[{"level":3,"title":"3.1 安装 Oh My Posh","slug":"_3-1-安装-oh-my-posh","link":"#_3-1-安装-oh-my-posh","children":[]},{"level":3,"title":"3.2 安装 Nerd 字体","slug":"_3-2-安装-nerd-字体","link":"#_3-2-安装-nerd-字体","children":[]},{"level":3,"title":"3.3 powershell使用oh-my-posh并选择主题","slug":"_3-3-powershell使用oh-my-posh并选择主题","link":"#_3-3-powershell使用oh-my-posh并选择主题","children":[]}]},{"level":2,"title":"4. 安装 posh-git 提供Git指令支持","slug":"_4-安装-posh-git-提供git指令支持","link":"#_4-安装-posh-git-提供git指令支持","children":[]}],"relativePath":"pages/posts/myNotes/guide/Optimizing_PowerShell.md","lastUpdated":null}'),{lazy:(t,n)=>t.name===n.name}),I={__name:"Optimizing_PowerShell",setup(t,{expose:n}){var p;const{data:k}=D(),r=c(),h=Object.assign(r.meta.frontmatter||{},((p=k.value)==null?void 0:p.frontmatter)||{});return r.meta.frontmatter=h,d("pageData",k.value),d("valaxy:frontmatter",h),globalThis.$frontmatter=h,n({frontmatter:{layout:"post",title:"优化PowerShell",date:"2024-10-03 19:55:00",categories:["教程"],excerpt:"PowerShell按键优化+美化"}}),(e,o)=>{const E=g;return F(),u(E,{frontmatter:m(h)},{"main-content-md":l(()=>o[0]||(o[0]=[s("h2",{id:"_0-精简版",tabindex:"-1"},[i("0. 精简版 "),s("a",{class:"header-anchor",href:"#_0-精简版","aria-label":'Permalink to "0. 精简版"'},"​")],-1),s("ol",null,[s("li",null,[s("p",null,[i("安装 "),s("code",null,"PSReadLine"),i(","),s("code",null,"oh-my-posh"),i(","),s("code",null,"posh-git")]),s("div",{style:{"max-height":"500px"},class:"language-powershell vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"powershell"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Install-Module"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PSReadLine "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Force "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"SkipPublisherCheck")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Set-ExecutionPolicy"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Bypass "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Scope "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Process"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Force; "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Invoke-Expression"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (("),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"New-Object"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," System.Net.WebClient).DownloadString("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'https://ohmyposh.dev/install.ps1'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"))")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Install-Module"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," posh"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"git "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Scope CurrentUser "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Force")])])]),s("button",{class:"collapse"})])]),s("li",null,[s("p",null,"打开PowerShell配置文件"),s("div",{style:{"max-height":"500px"},class:"language-powershell vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"powershell"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 打开配置文件")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"notepad "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"$PROFILE")])])]),s("button",{class:"collapse"})])]),s("li",null,[s("p",null,"在配置文件中输入一下内容"),s("div",{style:{"max-height":"500px"},class:"language-powershell vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"powershell"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 设置文本编码")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Console"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]::OutputEncoding "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ["),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"System.Text.Encoding"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]::UTF8 ")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 启动PSReadLine")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Import-Module"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PSReadLine")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Set-PSReadLineOption"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"EditMode Emacs")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Set-PSReadLineKeyHandler"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Chord Ctrl"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"v "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Function Paste")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Set-PSReadLineOption"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PredictionSource History")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Set-PSReadLineOption"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Colors "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Command            "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'Cyan'")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Parameter          "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'Yellow'")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    String             "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'Green'")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Operator           "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'White'")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Number             "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'Magenta'")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Comment            "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'DarkGreen'")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    ContinuationPrompt "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'DarkGray'")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# oh-my-posh")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"oh"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"my"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"posh init pwsh "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"--"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"config ~"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"AppData"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Local"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Programs"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"oh"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"my"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"posh"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"themes"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"my"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"theme.omp.json "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"|"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    Invoke-Expression")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# posh-git")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Import-Module"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," posh"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"git")])])]),s("button",{class:"collapse"})])]),s("li",null,[s("p",null,"安装Nerd字体并修改终端的字体"),s("p",null,[i("进这个网站下载一个Nerd字体并安装："),s("a",{href:"https://www.nerdfonts.com/",target:"_blank",rel:"noreferrer"},"https://www.nerdfonts.com/")]),s("p",null,[i("然后再使用的终端中修改字体，比如VSCode是在"),s("code",null,"Settings"),i("中的"),s("code",null,"terminal.integrated.fontFamily"),i("中修改")])])],-1),s("h2",{id:"_1-修改powershell编码",tabindex:"-1"},[i("1. 修改powershell编码 "),s("a",{class:"header-anchor",href:"#_1-修改powershell编码","aria-label":'Permalink to "1. 修改powershell编码"'},"​")],-1),s("p",null,"中文的windows系统下的powershell默认编码是gbk，常常导致一些程序输出乱码(单片机用C语言是这样的)。windows里",-1),s("p",null,"下面的powershell指令检查当前的编码：",-1),s("div",{style:{"max-height":"500px"},class:"language-powershell vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"powershell"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"console"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]::OutputEncoding")])])]),s("button",{class:"collapse"})],-1),s("p",null,"如果不是 UTF-8，使用以下命令将输出编码设置为 UTF-8：",-1),s("div",{style:{"max-height":"500px"},class:"language-powershell vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"powershell"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"console"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]::OutputEncoding "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ["),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"System.Text.Encoding"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]::UTF8")])])]),s("button",{class:"collapse"})],-1),s("p",null,[i("为了确保每次启动 PowerShell 时都将输出编码设置为 UTF-8，可以将设置写入 PowerShell 的 "),s("code",null,"profile"),i(" 文件。")],-1),s("ul",null,[s("li",null,[s("code",null,"AllUsersAllHosts"),i("：为所有用户和所有 PowerShell 会话加载（位于 PowerShell 安装目录下）。")]),s("li",null,[s("code",null,"AllUsersCurrentHost"),i("：为所有用户但仅在当前 PowerShell 主机中加载。")]),s("li",null,[s("code",null,"CurrentUserAllHosts"),i("：为当前用户但在所有 PowerShell 会话中加载。")]),s("li",null,[s("code",null,"CurrentUserCurrentHost"),i("：为当前用户且仅在当前 PowerShell 主机中加载。通常是指 "),s("code",null,"$PROFILE"),i("，位于用户主目录下。")]),s("li",null,[i("可以通过以下命令查看它们的位置： "),s("div",{style:{"max-height":"500px"},class:"language-powershell vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"powershell"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"$PROFILE"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," |"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Format-List"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," *"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Force")])])]),s("button",{class:"collapse"})]),i("输出类似下面这样 "),s("div",{style:{"max-height":"500px"},class:"language-powershell vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"powershell"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"AllUsersAllHosts       : C:\\Windows\\System32\\WindowsPowerShell\\v1."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"\\profile.ps1")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"AllUsersCurrentHost    : C:\\Windows\\System32\\WindowsPowerShell\\v1."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"\\Microsoft.  PowerShell_profile.ps1")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"CurrentUserAllHosts    : E:\\Users\\Huffer\\Documents\\WindowsPowerShell\\profile.ps1")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"CurrentUserCurrentHost : E:\\Users\\Huffer\\Documents\\WindowsPowerShell\\Microsoft. PowerShell_profile.ps1")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Length                 : "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"76")])])]),s("button",{class:"collapse"})])])],-1),s("p",null,[i("一般选择CurrentUserCurrentHost这一项的文件就行了，指令"),s("code",null,"$PROFILE"),i(" 默认打印CurrentUserCurrentHost配置文件的路径。")],-1),s("p",null,"在文件中添加以下内容：",-1),s("div",{style:{"max-height":"500px"},class:"language-powershell vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"powershell"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"console"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]::OutputEncoding "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ["),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"System.Text.Encoding"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]::UTF8")])])]),s("button",{class:"collapse"})],-1),s("p",null,"保存文件后，PowerShell 每次启动时都会自动应用这个设置。",-1),s("h2",{id:"_2-优化-powershell-补全",tabindex:"-1"},[i("2. 优化 PowerShell 补全 "),s("a",{class:"header-anchor",href:"#_2-优化-powershell-补全","aria-label":'Permalink to "2. 优化 PowerShell 补全"'},"​")],-1),s("p",null,[i("PowerShell的补全是一个一个轮流显示的，而不是bash那样根据上文补全的。"),s("code",null,"PSReadLine"),i(" 模块可以让 PowerShell 的体验更像 Linux 命令行一样。")],-1),s("p",null,[i("PSReadLine的Github仓库链接： "),s("a",{href:"https://github.com/PowerShell/PSReadLine",target:"_blank",rel:"noreferrer"},"https://github.com/PowerShell/PSReadLine")],-1),s("h3",{id:"_2-1-安装并加载-psreadline-模块",tabindex:"-1"},[i("2.1 安装并加载 "),s("code",null,"PSReadLine"),i(" 模块 "),s("a",{class:"header-anchor",href:"#_2-1-安装并加载-psreadline-模块","aria-label":'Permalink to "2.1 安装并加载 `PSReadLine` 模块"'},"​")],-1),s("p",null,[s("code",null,"PSReadLine"),i(" 通常预装在较新的 PowerShell 版本中。如果没有安装，可以使用以下命令安装：")],-1),s("div",{style:{"max-height":"500px"},class:"language-powershell vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"powershell"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Install-Module"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PSReadLine "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Force "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"SkipPublisherCheck")])])]),s("button",{class:"collapse"})],-1),s("h3",{id:"_2-2-修改-powershell-配置",tabindex:"-1"},[i("2.2 修改 PowerShell 配置 "),s("a",{class:"header-anchor",href:"#_2-2-修改-powershell-配置","aria-label":'Permalink to "2.2 修改 PowerShell 配置"'},"​")],-1),s("p",null,[i("和上面一样，打开 "),s("code",null,"$PROFILE"),i(" 配置文件,添加一下内容")],-1),s("div",{style:{"max-height":"500px"},class:"language-powershell vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"powershell"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Import-Module"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PSReadLine")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Set-PSReadLineOption"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"EditMode Emacs")])])]),s("button",{class:"collapse"})],-1),s("h2",{id:"_3-安装-oh-my-posh-来美化powershell",tabindex:"-1"},[i("3. 安装 oh-my-posh 来美化powershell "),s("a",{class:"header-anchor",href:"#_3-安装-oh-my-posh-来美化powershell","aria-label":'Permalink to "3. 安装 oh-my-posh 来美化powershell"'},"​")],-1),s("p",null,[s("a",{href:"https://ohmyposh.dev/",target:"_blank",rel:"noreferrer"},"Oh My Posh"),i("用于美化powershell，可以显示python环境以及git仓库信息之类的。")],-1),s("h3",{id:"_3-1-安装-oh-my-posh",tabindex:"-1"},[i("3.1 安装 Oh My Posh "),s("a",{class:"header-anchor",href:"#_3-1-安装-oh-my-posh","aria-label":'Permalink to "3.1 安装 Oh My Posh"'},"​")],-1),s("div",{style:{"max-height":"500px"},class:"language-powershell vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"powershell"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Set-ExecutionPolicy"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Bypass "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Scope "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Process"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Force; "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Invoke-Expression"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (("),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"New-Object"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," System.Net.WebClient).DownloadString("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'https://ohmyposh.dev/install.ps1'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"))")])])]),s("button",{class:"collapse"})],-1),s("h3",{id:"_3-2-安装-nerd-字体",tabindex:"-1"},[i("3.2 安装 Nerd 字体 "),s("a",{class:"header-anchor",href:"#_3-2-安装-nerd-字体","aria-label":'Permalink to "3.2 安装 Nerd 字体"'},"​")],-1),s("p",null,[s("a",{href:"https://ohmyposh.dev/docs/installation/fonts",target:"_blank",rel:"noreferrer"},"官网教程: https://ohmyposh.dev/docs/installation/fonts")],-1),s("p",null,[i("安装显示图标需要的"),s("a",{href:"https://www.nerdfonts.com/",target:"_blank",rel:"noreferrer"},"Nerd"),i("字体,否则就会像下图这样，不能正常显示。我使用的是"),s("a",{href:"https://github.com/ryanoasis/nerd-fonts/releases/download/v3.2.1/CascadiaMono.zip",target:"_blank",rel:"noreferrer"},"CaskaydiaMonoNerdFontMono-Regular.ttf")],-1),s("figure",null,[s("img",{src:w,alt:"字体乱码",loading:"lazy",decoding:"async"})],-1),s("p",null,"安装完成过后需要设置终端使用的字体，Windows Terminal的修改方式如下",-1),s("figure",null,[s("img",{src:C,alt:"打开外观设置",loading:"lazy",decoding:"async"})],-1),s("figure",null,[s("img",{src:b,alt:"选择字体",loading:"lazy",decoding:"async"})],-1),s("p",null,"VSCode的话再设置里搜索terminal.integrated.fontFamily",-1),s("p",null,"填上安装的字体就可以",-1),s("h3",{id:"_3-3-powershell使用oh-my-posh并选择主题",tabindex:"-1"},[i("3.3 powershell使用oh-my-posh并选择主题 "),s("a",{class:"header-anchor",href:"#_3-3-powershell使用oh-my-posh并选择主题","aria-label":'Permalink to "3.3 powershell使用oh-my-posh并选择主题"'},"​")],-1),s("p",null,"打开powershell的配置文件，添加以下内容",-1),s("div",{style:{"max-height":"500px"},class:"language-powershell vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"powershell"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"oh"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"my"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"posh init pwsh "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"--"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"config ~"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"AppData"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Local"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Programs"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"oh"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"my"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"posh"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"themes"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"my"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"theme.omp.json "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"|"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Invoke-Expression")])])]),s("button",{class:"collapse"})],-1),s("p",null,[i("其中"),s("code",null,"~/AppData/Local/Programs/oh-my-posh/themes/my-theme.omp.json"),i("是主题配置文件的路径，我的主题是在"),s("a",{href:"https://github.com/JanDeDobbeleer/oh-my-posh/blob/main/themes/catppuccin.omp.json",target:"_blank",rel:"noreferrer"},"catppuccin主题"),i("的基础上改过来的,链接："),s("a",{href:"https://github.com/Huffer342-WSH/myNotes/blob/main/guide/resource/my-theme.omp.json",target:"_blank",rel:"noreferrer"},"my-theme.omp.json")],-1),s("p",null,"我的主题在VSCode里是下图的效果，会显示git和python环境的信息",-1),s("figure",null,[s("img",{src:v,alt:"alt text",loading:"lazy",decoding:"async"})],-1),s("h2",{id:"_4-安装-posh-git-提供git指令支持",tabindex:"-1"},[i("4. 安装 posh-git 提供Git指令支持 "),s("a",{class:"header-anchor",href:"#_4-安装-posh-git-提供git指令支持","aria-label":'Permalink to "4. 安装 posh-git 提供Git指令支持"'},"​")],-1),s("p",null,"安装",-1),s("div",{style:{"max-height":"500px"},class:"language-powershell vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"powershell"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Install-Module"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," posh"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"git "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Scope CurrentUser "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Force")])])]),s("button",{class:"collapse"})],-1),s("p",null,[i("在 PowerShell 配置配置文件中添加以下内容以导入 "),s("code",null,"posh-git"),i(" 模块")],-1),s("div",{style:{"max-height":"500px"},class:"language-powershell vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"powershell"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Import-Module"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," posh"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"git")])])]),s("button",{class:"collapse"})],-1)])),"main-header":l(()=>[a(e.$slots,"main-header")]),"main-header-after":l(()=>[a(e.$slots,"main-header-after")]),"main-nav":l(()=>[a(e.$slots,"main-nav")]),"main-content-before":l(()=>[a(e.$slots,"main-content-before")]),"main-content":l(()=>[a(e.$slots,"main-content")]),"main-content-after":l(()=>[a(e.$slots,"main-content-after")]),"main-nav-before":l(()=>[a(e.$slots,"main-nav-before")]),"main-nav-after":l(()=>[a(e.$slots,"main-nav-after")]),comment:l(()=>[a(e.$slots,"comment")]),footer:l(()=>[a(e.$slots,"footer")]),aside:l(()=>[a(e.$slots,"aside")]),"aside-custom":l(()=>[a(e.$slots,"aside-custom")]),default:l(()=>[a(e.$slots,"default")]),_:3},8,["frontmatter"])}}};export{I as default,D as usePageData};
